<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#0f172a" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="manifest" href="./manifest.json" />
    <title>GymNerd</title>
    <link rel="icon" href="favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,200,0,0" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,200,0,0&icon_names=finance" />
    <script src="gn-i18n.js"></script>
    <style>
        body {
            margin: 0;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            visibility: visible; /* shell should be visible; pages control hiding */
            background: #0f172a;
            padding-top: 0; /* let page topbars control their own safe-area spacing */
        }
        /* ensure the page content has room at the bottom for the fixed nav */
        .main-content { min-height: 100vh; padding: 0 0 calc(84px + env(safe-area-inset-bottom)) !important; margin: 0 !important; }
        /* Bottom navigation (mobile) - opaque background and solid border
           centered and constrained to the app max-width so it never exceeds
           the top-card width on wide screens */
        #bottom-nav {
            position: fixed;
            left: 50%;
            transform: translateX(-50%);
            bottom: 0;
            display: none;
            gap: 8px;
            justify-content: space-around;
            align-items: center;
            padding: 10px 8px;
            background: #0f172a;
            border-top: 1px solid #0b1220;
            box-shadow: 0 -6px 20px rgba(0,0,0,0.25);
            z-index: 1400;
            padding-bottom: calc(12px + env(safe-area-inset-bottom));
            width: 100%;
            max-width: var(--app-max-width);
        }
        #bottom-nav a { color: #94a3b8; text-decoration: none; display:flex; flex-direction:column; align-items:center; gap:4px; font-size:12px; padding:6px 8px; border-radius:10px; }
        #bottom-nav a .nav-icon { width:auto; height:auto; display:inline-flex; align-items:center; justify-content:center; font-size:20px; line-height:1; }
        #bottom-nav a.active { color: #fff; background: rgba(59,130,246,0.08); }

        /* Make all nav items the same width except the prominent Play button */
        #bottom-nav a:not(#nav-play) {
            box-sizing: border-box;
            flex: 0 0 64px;
            width: 64px;
            padding-left: 6px;
            padding-right: 6px;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Prominent centered Play button styling (offset above the nav) */
        #bottom-nav a#nav-play {
            position: relative;
            top: -22px; /* lift the button above the bar */
            width: 64px;
            height: 64px;
            padding: 0;
            border-radius: 16px;
            background: var(--primary-grad);
            display:flex;
            align-items:center;
            justify-content:center;
            color: #ffffff;
            box-shadow: 0 10px 20px rgba(37,99,235,0.3);
        }
        #bottom-nav a#nav-play .nav-icon { width:auto; height:auto; font-size:28px; }
        /* hide only the text label in the Play button, keep the icon visible */
        #bottom-nav a#nav-play span:not(.nav-icon) { display:none; }

        /* Safe-area overlay for system status bar and helper topbar class
           - `body::before` paints the area under the OS status bar (iOS/Android)
           - Set `--status-bar-bg` on `body` or `:root` to change that color per-page
           - Use `.app-topbar` on page top bars to apply spacing so content doesn't overlap
        */
        :root { --status-bar-bg: transparent; --topbar-bg: transparent; --app-max-width: 500px; }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: constant(safe-area-inset-top);
            height: env(safe-area-inset-top);
            background: var(--status-bar-bg, transparent);
            z-index: 1200;
            pointer-events: none;
        }
        .app-topbar {
            background: var(--topbar-bg, transparent);
            padding-top: calc(12px + constant(safe-area-inset-top));
            padding-top: calc(12px + env(safe-area-inset-top));
            position: relative;
            z-index: 1201;
        }
    </style>
</head>

<body>
    <div class="main-content" id="app-shell">
        <!-- SPA root shell. `spa.js` will inject login.html or other pages here. -->
    </div>

    <!-- Bottom navigation (SPA will toggle visibility) -->
    <nav id="bottom-nav" aria-hidden="true" role="navigation">
        <a id="nav-home" href="home.html" aria-label="Home">
            <span class="material-symbols-outlined nav-icon">home</span>
            <span data-i18n="menu_home">Home</span>
        </a>
        <a id="nav-routines" href="routines.html" aria-label="Routines">
            <span class="material-symbols-outlined nav-icon">exercise</span>
            <span data-i18n="menu_routines">Routines</span>
        </a>
        <a id="nav-play" href="/livesession.html" aria-label="Play">
            <span class="material-symbols-outlined nav-icon">play_arrow</span>
            <span data-i18n="menu_start_routine">Play</span>
        </a>
        <a id="nav-history" href="history.html" aria-label="History">
            <span class="material-symbols-outlined nav-icon">history</span>
            <span data-i18n="menu_history">History</span>
        </a>
        <a id="nav-statistics" href="statistics.html" aria-label="Statistics">
            <span class="material-symbols-outlined nav-icon">finance</span>
            <span data-i18n="menu_statistics">Stats</span>
        </a>
    </nav>

    <script>
        try {
            // Apply translations only to bottom nav labels
            GN_I18N.safeApplyTranslations(document.getElementById('bottom-nav'));
            // Also update aria-labels to localized text
            var map = {
                'nav-home': 'menu_home',
                'nav-routines': 'menu_routines',
                'nav-play': 'menu_start_routine',
                'nav-history': 'menu_history',
                'nav-statistics': 'menu_statistics'
            };
            Object.keys(map).forEach(function(id){
                var el = document.getElementById(id);
                if (el) el.setAttribute('aria-label', GN_I18N.safeT(map[id]));
            });
        } catch(e) { console.warn('bottom-nav i18n failed', e); }
    </script>

    <script src="auth.js"></script>
    <script src="spa.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js').then(() => console.log('Service worker registered from index')).catch(err => console.warn('SW registration failed', err));
        }
    </script>
</body>

</html>